/**
 * Created by w44 on 15-1-12.
 */


var mongodb = require('mongodb');

var config = require('print_config');
var prop = config.prop;
var server = new mongodb.Server(prop.mongodbUrl, prop.mongodbPort, {auto_reconnect: true});

var db = new mongodb.Db(prop.dbName, server, {safe: true});


var MongoDBUtil = function () {
};


MongoDBUtil.prototype.init = function(cb){
    var self = this;
    db.open(function (err, collections) {
        if(err){
            console.log("数据库初始化失败")
            cb(err);
        }else{
            self.db = collections;
            cb(null);
        }
    });
};

var mongoDBUtil = new MongoDBUtil();


module.exports = mongoDBUtil;